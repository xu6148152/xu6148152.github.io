<!DOCTYPE html>
<html lang="default">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"xu6148152.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.12.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Blog">
<meta property="og:url" content="http://xu6148152.github.io/page/6/index.html">
<meta property="og:site_name" content="Blog">
<meta property="og:locale">
<meta property="article:author" content="Binea">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://xu6148152.github.io/page/6/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"default","comments":"","permalink":"","path":"page/6/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Blog</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Binea</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">63</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">33</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://xu6148152.github.io/2016/06/04/analysis-recyclerview/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Binea">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2016/06/04/analysis-recyclerview/" class="post-title-link" itemprop="url">recyclerview-structure</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-06-04 16:51:53" itemprop="dateCreated datePublished" datetime="2016-06-04T16:51:53+08:00">2016-06-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-06-08 18:12:50" itemprop="dateModified" datetime="2022-06-08T18:12:50+08:00">2022-06-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>本系列主要分析<code>RecyclerView</code>的源码。本文主要分析<code>RecyclerView</code>的源码结构，以及其各机构的作用。首先来看一下<code>RecyclerView</code>的源码结构:</p>
<img data-src="/2016/06/04/analysis-recyclerview/RecyclerView.jpg" class="">

<p>从图上可以看出<code>RecyclerView</code>依赖了很多别的类。接下来我们首先介绍各个类的作用。</p>
<ul>
<li>RecyclerViewDataObserver 数据观察器</li>
<li>Recycler View循环复用系统，核心部件</li>
<li>SavedState RecyclerView状态</li>
<li>AdapterHelper 适配器更新</li>
<li>ChildHelper 管理子View</li>
<li>ViewInfoStore 存储子VIEW的动画信息</li>
<li>Adapter 数据适配器</li>
<li>LayoutManager 负责子VIEW的布局，核心部件</li>
<li>ItemAnimator Item动画</li>
<li>ViewFlinger 快速滑动管理</li>
<li>NestedScrollingChildHelper 管理子VIEW嵌套滑动</li>
</ul>
<p>###创建布局管理器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">private void createLayoutManager(Context context, String className, AttributeSet attrs,</span><br><span class="line">            int defStyleAttr, int defStyleRes) &#123;</span><br><span class="line">        if (className != null) &#123;</span><br><span class="line">            className = className.trim();</span><br><span class="line">            if (className.length() != 0) &#123;  // Can&#x27;t use isEmpty since it was added in API 9.</span><br><span class="line">                className = getFullClassName(context, className);</span><br><span class="line">                try &#123;</span><br><span class="line">                    ClassLoader classLoader;</span><br><span class="line">                    if (isInEditMode()) &#123;</span><br><span class="line">                        // Stupid layoutlib cannot handle simple class loaders.</span><br><span class="line">                        classLoader = this.getClass().getClassLoader();</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        classLoader = context.getClassLoader();</span><br><span class="line">                    &#125;</span><br><span class="line">                    Class&lt;? extends LayoutManager&gt; layoutManagerClass =</span><br><span class="line">                            classLoader.loadClass(className).asSubclass(LayoutManager.class);</span><br><span class="line">                    Constructor&lt;? extends LayoutManager&gt; constructor;</span><br><span class="line">                    Object[] constructorArgs = null;</span><br><span class="line">                    try &#123;</span><br><span class="line">                        constructor = layoutManagerClass</span><br><span class="line">                                .getConstructor(LAYOUT_MANAGER_CONSTRUCTOR_SIGNATURE);</span><br><span class="line">                        constructorArgs = new Object[]&#123;context, attrs, defStyleAttr, defStyleRes&#125;;</span><br><span class="line">                    &#125; catch (NoSuchMethodException e) &#123;</span><br><span class="line">                        try &#123;</span><br><span class="line">                            constructor = layoutManagerClass.getConstructor();</span><br><span class="line">                        &#125; catch (NoSuchMethodException e1) &#123;</span><br><span class="line">                            e1.initCause(e);</span><br><span class="line">                            throw new IllegalStateException(attrs.getPositionDescription() +</span><br><span class="line">                                    &quot;: Error creating LayoutManager &quot; + className, e1);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    constructor.setAccessible(true);</span><br><span class="line">                    setLayoutManager(constructor.newInstance(constructorArgs));</span><br><span class="line">                &#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">                    throw new IllegalStateException(attrs.getPositionDescription()</span><br><span class="line">                            + &quot;: Unable to find LayoutManager &quot; + className, e);</span><br><span class="line">                &#125; catch (InvocationTargetException e) &#123;</span><br><span class="line">                    throw new IllegalStateException(attrs.getPositionDescription()</span><br><span class="line">                            + &quot;: Could not instantiate the LayoutManager: &quot; + className, e);</span><br><span class="line">                &#125; catch (InstantiationException e) &#123;</span><br><span class="line">                    throw new IllegalStateException(attrs.getPositionDescription()</span><br><span class="line">                            + &quot;: Could not instantiate the LayoutManager: &quot; + className, e);</span><br><span class="line">                &#125; catch (IllegalAccessException e) &#123;</span><br><span class="line">                    throw new IllegalStateException(attrs.getPositionDescription()</span><br><span class="line">                            + &quot;: Cannot access non-public constructor &quot; + className, e);</span><br><span class="line">                &#125; catch (ClassCastException e) &#123;</span><br><span class="line">                    throw new IllegalStateException(attrs.getPositionDescription()</span><br><span class="line">                            + &quot;: Class is not a LayoutManager &quot; + className, e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>如果在布局文件里面设置了布局管理器的类型，那么这里会通过反射的方式实例化出对应的布局管理器。最后将实例化出的布局管理器设置到当前的<code>RecyclerView</code></p>
<p>###设置布局管理器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">public void setLayoutManager(LayoutManager layout) &#123;</span><br><span class="line">        if (layout == mLayout) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        //停止滚动</span><br><span class="line">        stopScroll();</span><br><span class="line">        // TODO We should do this switch a dispachLayout pass and animate children. There is a good</span><br><span class="line">        // chance that LayoutManagers will re-use views.</span><br><span class="line">        if (mLayout != null) &#123;</span><br><span class="line">            if (mIsAttached) &#123;</span><br><span class="line">                mLayout.dispatchDetachedFromWindow(this, mRecycler);</span><br><span class="line">            &#125;</span><br><span class="line">            mLayout.setRecyclerView(null);</span><br><span class="line">        &#125;</span><br><span class="line">        //清空缓存</span><br><span class="line">        mRecycler.clear();</span><br><span class="line">        mChildHelper.removeAllViewsUnfiltered();</span><br><span class="line">        mLayout = layout;</span><br><span class="line">        if (layout != null) &#123;</span><br><span class="line">            if (layout.mRecyclerView != null) &#123;</span><br><span class="line">                throw new IllegalArgumentException(&quot;LayoutManager &quot; + layout +</span><br><span class="line">                        &quot; is already attached to a RecyclerView: &quot; + layout.mRecyclerView);</span><br><span class="line">            &#125;</span><br><span class="line">            mLayout.setRecyclerView(this);</span><br><span class="line">            if (mIsAttached) &#123;</span><br><span class="line">                mLayout.dispatchAttachedToWindow(this);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        requestLayout();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>设置布局管理器之前会先清空所有之前的缓存VIEW。最后通知VIEW刷新</p>
<p>###onMeasure<br>onMeasure这个回调方法用于测量<code>VIEW</code>的大小</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">protected void onMeasure(int widthSpec, int heightSpec) &#123;</span><br><span class="line">        if (mLayout == null) &#123;</span><br><span class="line">            defaultOnMeasure(widthSpec, heightSpec);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        if (mLayout.mAutoMeasure) &#123;</span><br><span class="line">            final int widthMode = MeasureSpec.getMode(widthSpec);</span><br><span class="line">            final int heightMode = MeasureSpec.getMode(heightSpec);</span><br><span class="line">            final boolean skipMeasure = widthMode == MeasureSpec.EXACTLY</span><br><span class="line">                    &amp;&amp; heightMode == MeasureSpec.EXACTLY;</span><br><span class="line">            mLayout.onMeasure(mRecycler, mState, widthSpec, heightSpec);</span><br><span class="line">            if (skipMeasure || mAdapter == null) &#123;</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">            if (mState.mLayoutStep == State.STEP_START) &#123;</span><br><span class="line">                dispatchLayoutStep1();</span><br><span class="line">            &#125;</span><br><span class="line">            // set dimensions in 2nd step. Pre-layout should happen with old dimensions for</span><br><span class="line">            // consistency</span><br><span class="line">            mLayout.setMeasureSpecs(widthSpec, heightSpec);</span><br><span class="line">            mState.mIsMeasuring = true;</span><br><span class="line">            dispatchLayoutStep2();</span><br><span class="line"></span><br><span class="line">            // now we can get the width and height from the children.</span><br><span class="line">            mLayout.setMeasuredDimensionFromChildren(widthSpec, heightSpec);</span><br><span class="line"></span><br><span class="line">            // if RecyclerView has non-exact width and height and if there is at least one child</span><br><span class="line">            // which also has non-exact width &amp; height, we have to re-measure.</span><br><span class="line">            if (mLayout.shouldMeasureTwice()) &#123;</span><br><span class="line">                mLayout.setMeasureSpecs(</span><br><span class="line">                        MeasureSpec.makeMeasureSpec(getMeasuredWidth(), MeasureSpec.EXACTLY),</span><br><span class="line">                        MeasureSpec.makeMeasureSpec(getMeasuredHeight(), MeasureSpec.EXACTLY));</span><br><span class="line">                mState.mIsMeasuring = true;</span><br><span class="line">                dispatchLayoutStep2();</span><br><span class="line">                // now we can get the width and height from the children.</span><br><span class="line">                mLayout.setMeasuredDimensionFromChildren(widthSpec, heightSpec);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            if (mHasFixedSize) &#123;</span><br><span class="line">                mLayout.onMeasure(mRecycler, mState, widthSpec, heightSpec);</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">            // custom onMeasure</span><br><span class="line">            if (mAdapterUpdateDuringMeasure) &#123;</span><br><span class="line">                eatRequestLayout();</span><br><span class="line">                processAdapterUpdatesAndSetAnimationFlags();</span><br><span class="line"></span><br><span class="line">                if (mState.mRunPredictiveAnimations) &#123;</span><br><span class="line">                    mState.mInPreLayout = true;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    // consume remaining updates to provide a consistent state with the layout pass.</span><br><span class="line">                    mAdapterHelper.consumeUpdatesInOnePass();</span><br><span class="line">                    mState.mInPreLayout = false;</span><br><span class="line">                &#125;</span><br><span class="line">                mAdapterUpdateDuringMeasure = false;</span><br><span class="line">                resumeRequestLayout(false);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if (mAdapter != null) &#123;</span><br><span class="line">                mState.mItemCount = mAdapter.getItemCount();</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                mState.mItemCount = 0;</span><br><span class="line">            &#125;</span><br><span class="line">            eatRequestLayout();</span><br><span class="line">            mLayout.onMeasure(mRecycler, mState, widthSpec, heightSpec);</span><br><span class="line">            resumeRequestLayout(false);</span><br><span class="line">            mState.mInPreLayout = false; // clear</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>从上述代码可以看出，</p>
<ul>
<li>如果布局是空的，那么<code>RecyclerView</code>会创建调用<code>defaultOnMeasure</code>方法</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">    * Used when onMeasure is called before layout manager is set</span><br><span class="line">    */</span><br><span class="line">   void defaultOnMeasure(int widthSpec, int heightSpec) &#123;</span><br><span class="line">       // calling LayoutManager here is not pretty but that API is already public and it is better</span><br><span class="line">       // than creating another method since this is internal.</span><br><span class="line">       final int width = LayoutManager.chooseSize(widthSpec,</span><br><span class="line">               getPaddingLeft() + getPaddingRight(),</span><br><span class="line">               ViewCompat.getMinimumWidth(this));</span><br><span class="line">       final int height = LayoutManager.chooseSize(heightSpec,</span><br><span class="line">               getPaddingTop() + getPaddingBottom(),</span><br><span class="line">               ViewCompat.getMinimumHeight(this));</span><br><span class="line"></span><br><span class="line">       setMeasuredDimension(width, height);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>默认测量是布局管理器根据指定的宽，高规格，算出宽高。</p>
<ul>
<li>如果是自动布局，如果宽高都是明确指定的，那么跳过测量。否则，如果</li>
<li>目前是初始阶段，那么调用<code>dispatchLayoutStep1</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">    * The first step of a layout where we;</span><br><span class="line">    * - process adapter updates</span><br><span class="line">    * - decide which animation should run</span><br><span class="line">    * - save information about current views</span><br><span class="line">    * - If necessary, run predictive layout and save its information</span><br><span class="line">    */</span><br></pre></td></tr></table></figure>
<ul>
<li>第二步，用老的尺寸规格来预布局，然后调用<code>dispatchLayoutStep2</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">private void dispatchLayoutStep2() &#123;</span><br><span class="line">        eatRequestLayout();</span><br><span class="line">        onEnterLayoutOrScroll();</span><br><span class="line">        mState.assertLayoutStep(State.STEP_LAYOUT | State.STEP_ANIMATIONS);</span><br><span class="line">        mAdapterHelper.consumeUpdatesInOnePass();</span><br><span class="line">        mState.mItemCount = mAdapter.getItemCount();</span><br><span class="line">        mState.mDeletedInvisibleItemCountSincePreviousLayout = 0;</span><br><span class="line"></span><br><span class="line">        // Step 2: Run layout</span><br><span class="line">        mState.mInPreLayout = false;</span><br><span class="line">        mLayout.onLayoutChildren(mRecycler, mState);</span><br><span class="line"></span><br><span class="line">        mState.mStructureChanged = false;</span><br><span class="line">        mPendingSavedState = null;</span><br><span class="line"></span><br><span class="line">        // onLayoutChildren may have caused client code to disable item animations; re-check</span><br><span class="line">        mState.mRunSimpleAnimations = mState.mRunSimpleAnimations &amp;&amp; mItemAnimator != null;</span><br><span class="line">        mState.mLayoutStep = State.STEP_ANIMATIONS;</span><br><span class="line">        onExitLayoutOrScroll();</span><br><span class="line">        resumeRequestLayout(false);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>这之后我们就能够获取子<code>VIEW</code>的宽高了。如果<code>RecyclerView</code>没有明确的宽高，那么我们需要再次测量，然后重复上述步骤。</li>
<li>如果不是自动布局，如果是固定大小，那么直接用现有规格测量。否则首先进行一些动画前置操作，最后依然由布局管理器来测量。</li>
</ul>
<p>###onLayout<br><code>onLayout</code>是确定位置时的回调方法。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">   protected void onLayout(boolean changed, int l, int t, int r, int b) &#123;</span><br><span class="line">       TraceCompat.beginSection(TRACE_ON_LAYOUT_TAG);</span><br><span class="line">       dispatchLayout();</span><br><span class="line">       TraceCompat.endSection();</span><br><span class="line">       mFirstLayoutComplete = true;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p><code>dispatchLayout</code>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">void dispatchLayout() &#123;</span><br><span class="line">       if (mAdapter == null) &#123;</span><br><span class="line">           Log.e(TAG, &quot;No adapter attached; skipping layout&quot;);</span><br><span class="line">           // leave the state in START</span><br><span class="line">           return;</span><br><span class="line">       &#125;</span><br><span class="line">       if (mLayout == null) &#123;</span><br><span class="line">           Log.e(TAG, &quot;No layout manager attached; skipping layout&quot;);</span><br><span class="line">           // leave the state in START</span><br><span class="line">           return;</span><br><span class="line">       &#125;</span><br><span class="line">       mState.mIsMeasuring = false;</span><br><span class="line">       if (mState.mLayoutStep == State.STEP_START) &#123;</span><br><span class="line">           dispatchLayoutStep1();</span><br><span class="line">           mLayout.setExactMeasureSpecsFrom(this);</span><br><span class="line">           dispatchLayoutStep2();</span><br><span class="line">       &#125; else if (mAdapterHelper.hasUpdates() || mLayout.getWidth() != getWidth() ||</span><br><span class="line">               mLayout.getHeight() != getHeight()) &#123;</span><br><span class="line">           // First 2 steps are done in onMeasure but looks like we have to run again due to</span><br><span class="line">           // changed size.</span><br><span class="line">           mLayout.setExactMeasureSpecsFrom(this);</span><br><span class="line">           dispatchLayoutStep2();</span><br><span class="line">       &#125; else &#123;</span><br><span class="line">           // always make sure we sync them (to ensure mode is exact)</span><br><span class="line">           mLayout.setExactMeasureSpecsFrom(this);</span><br><span class="line">       &#125;</span><br><span class="line">       dispatchLayoutStep3();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>如果是初始状态，调用<code>dispatchLayoutStep1</code>，测量，调用<code>dispatchLayoutStep2</code>。如果高度或宽度发生变化，测量，调用<code>dispatchLayoutStep2</code>。其他情况制作测量。最后统一调用<code>dispatchLayoutStep3</code>主要处理动画。</li>
</ul>
<p>###onDraw<br><code>onDraw</code>是绘制时的回调  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">   public void onDraw(Canvas c) &#123;</span><br><span class="line">       super.onDraw(c);</span><br><span class="line"></span><br><span class="line">       final int count = mItemDecorations.size();</span><br><span class="line">       for (int i = 0; i &lt; count; i++) &#123;</span><br><span class="line">           mItemDecorations.get(i).onDraw(c, this, mState);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>主要对<code>ItemDecoration</code>的绘制</p>
<p>至此，<code>RecyclerView</code>的主要回调方法已经简单介绍完毕。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://xu6148152.github.io/2016/05/04/OpenGl-Learning-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Binea">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2016/05/04/OpenGl-Learning-1/" class="post-title-link" itemprop="url">OpenGL Learning(1)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2016-05-04 00:13:50 / Modified: 00:21:17" itemprop="dateCreated datePublished" datetime="2016-05-04T00:13:50+08:00">2016-05-04</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="定点和着色器"><a href="#定点和着色器" class="headerlink" title="定点和着色器"></a>定点和着色器</h3><blockquote>
<p>OpenGl只能绘制点、直线及三角形,定义定点时总是以逆时针的顺序排列定点。这称为卷曲顺序。  </p>
</blockquote>
<blockquote>
<p>告诉GPU如何绘制数据的东西被称为着色器。着色器分为顶点着色器(vertex shader)和片段着色器(fragment shader)  </p>
</blockquote>
<p><img data-src="/./opengl2-6.png"></p>
<h4 id="创建第一个顶点着色器"><a href="#创建第一个顶点着色器" class="headerlink" title="创建第一个顶点着色器"></a>创建第一个顶点着色器</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">attribute vec4 a_Position;</span><br><span class="line"></span><br><span class="line">void main() &#123;</span><br><span class="line">	gl_Position = a_Position;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>OpenGL</code>会把<code>gl_Position</code>中的值当作当前定点的最终位置。</p>
<h4 id="创建第一个片段着色器"><a href="#创建第一个片段着色器" class="headerlink" title="创建第一个片段着色器"></a>创建第一个片段着色器</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">precision mediump float;</span><br><span class="line"></span><br><span class="line">uniform vec4 u_Color;</span><br><span class="line"></span><br><span class="line">void main() &#123;</span><br><span class="line">	gl_FragColor = u_Color;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>OpenGl</code>会把<code>gl_FragColor</code>的值作为当前片段的最终颜色</p>
<h4 id="加载着色器"><a href="#加载着色器" class="headerlink" title="加载着色器"></a>加载着色器</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">public class TextureResourceReader &#123;</span><br><span class="line">    public static String readTextFileFromResource(Context context, int resId) &#123;</span><br><span class="line">        StringBuilder sb = new StringBuilder();</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            InputStream is = context.getResources().openRawResource(resId);</span><br><span class="line">            InputStreamReader isr = new InputStreamReader(is);</span><br><span class="line">            BufferedReader br = new BufferedReader(isr);</span><br><span class="line">            String nextLine;</span><br><span class="line"></span><br><span class="line">            while ((nextLine = br.readLine()) != null) &#123;</span><br><span class="line">                sb.append(nextLine);</span><br><span class="line">                sb.append(&#x27;\n&#x27;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            throw new RuntimeException(&quot;Could not open resource: &quot; + resId, e);</span><br><span class="line">        &#125; catch (Resources.NotFoundException e) &#123;</span><br><span class="line">            throw new RuntimeException(&quot;Resource not found: &quot; + resId, e);</span><br><span class="line">        &#125;</span><br><span class="line">        return sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="读入着色器代码"><a href="#读入着色器代码" class="headerlink" title="读入着色器代码"></a>读入着色器代码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Override protected String readVertexShader() &#123;</span><br><span class="line">        return TextureResourceReader.readTextFileFromResource(mContext, R.raw.simple_vertex_shader);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override protected String readFragmentShader() &#123;</span><br><span class="line">        return TextureResourceReader.readTextFileFromResource(mContext,</span><br><span class="line">                                                              R.raw.simple_fragment_shader);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="编译着色器"><a href="#编译着色器" class="headerlink" title="编译着色器"></a>编译着色器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">public static int compileVertexShader(String shaderCode) &#123;</span><br><span class="line">       return compileShader(GL_VERTEX_SHADER, shaderCode);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public static int compileFragmentShader(String shaderCode) &#123;</span><br><span class="line">       return compileShader(GL_FRAGMENT_SHADER, shaderCode);</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">private static int compileShader(int type, String shaderCode) &#123;</span><br><span class="line">       final int shaderObjectId = glCreateShader(type);</span><br><span class="line"></span><br><span class="line">       if (shaderObjectId == 0) &#123;</span><br><span class="line">           LogHelper.w(TAG, &quot;Could not create new shader.&quot;);</span><br><span class="line">           return 0;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       glShaderSource(shaderObjectId, shaderCode);</span><br><span class="line">       glCompileShader(shaderObjectId);</span><br><span class="line"></span><br><span class="line">       final int[] compileStatus = new int[1];</span><br><span class="line">       glGetShaderiv(shaderObjectId, GL_COMPILE_STATUS, compileStatus, 0);</span><br><span class="line"></span><br><span class="line">       LogHelper.v(TAG,</span><br><span class="line">                   &quot;Results of compiling source:&quot; + &quot;\n&quot; + shaderCode + &quot;\n&quot; + glGetShaderInfoLog(</span><br><span class="line">                           shaderObjectId));</span><br><span class="line"></span><br><span class="line">       if (compileStatus[0] == 0) &#123;</span><br><span class="line">           glDeleteShader(shaderObjectId);</span><br><span class="line"></span><br><span class="line">           LogHelper.w(TAG, &quot;Compilation of shader failed&quot;);</span><br><span class="line">           return 0;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       return shaderObjectId;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="链接着色器"><a href="#链接着色器" class="headerlink" title="链接着色器"></a>链接着色器</h3><p>一个OpenGL程序就是把一个顶点着色器和一个片段着色器链接在一起变成单个对象，顶点着色器和片段着色器总是在一起工作的。片段着色器负责绘制那些组成每个点、直线和三角形的片段；顶点着色器确定在哪里绘制。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">public static int linkProgram(int vertextShaderId, int fragmentShaderId) &#123;</span><br><span class="line">       final int programObjectId = glCreateProgram();</span><br><span class="line"></span><br><span class="line">       if (programObjectId == 0) &#123;</span><br><span class="line">           LogHelper.w(TAG, &quot;Could not create new program&quot;);</span><br><span class="line">           return 0;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       glAttachShader(programObjectId, vertextShaderId);</span><br><span class="line">       glAttachShader(programObjectId, fragmentShaderId);</span><br><span class="line"></span><br><span class="line">       glLinkProgram(programObjectId);</span><br><span class="line"></span><br><span class="line">       final int[] status = new int[1];</span><br><span class="line">       glGetProgramiv(programObjectId, GL_LINK_STATUS, status, 0);</span><br><span class="line"></span><br><span class="line">       LogHelper.v(TAG, &quot;Result of linking program: \n&quot; + glGetProgramInfoLog(programObjectId));</span><br><span class="line"></span><br><span class="line">       if (status[0] == 0) &#123;</span><br><span class="line">           glDeleteProgram(programObjectId);</span><br><span class="line">           LogHelper.w(TAG, &quot;Linking of program failed.&quot;);</span><br><span class="line">           return 0;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       return programObjectId;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="最后的拼接"><a href="#最后的拼接" class="headerlink" title="最后的拼接"></a>最后的拼接</h3><ul>
<li>获取一个<code>uniform</code>的位置</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">glGetUniformLocation(program, U_COLOR);</span><br><span class="line">	</span><br></pre></td></tr></table></figure>
<ul>
<li>获取属性的位置</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">glGetAttribLocation(program, A_COLOR);</span><br></pre></td></tr></table></figure>

<ul>
<li>关联属性和定点数据的数组</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vertexData.position(0);</span><br><span class="line">//****** very import method *******//</span><br><span class="line">glVertexAttribPointer(aPositionLocation, POSITION_COMPONENT_COUNT, GL_FLOAT, false, STRIDE,</span><br><span class="line">                      vertexData);</span><br></pre></td></tr></table></figure>

<ul>
<li>使能顶点数组</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">glEnableVertexAttribArray(aPositionLocation);</span><br></pre></td></tr></table></figure>

<ul>
<li>绘制</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">glClear(GL_COLOR_BUFFER_BIT);</span><br><span class="line"></span><br><span class="line">//set triangle color</span><br><span class="line">//glUniform4f(uColorLocation, 1.0f, 1.0f, 1.0f, 1.0f);</span><br><span class="line">//draw two triangles</span><br><span class="line">glDrawArrays(GL_TRIANGLE_FAN, 0, 6);</span><br><span class="line"></span><br><span class="line">//set line color</span><br><span class="line">//glUniform4f(uColorLocation, 1.0f, 0.0f, 0.0f, 1.0f);</span><br><span class="line">glDrawArrays(GL_LINES, 6, 2);</span><br><span class="line"></span><br><span class="line">//draw the first blue mallets</span><br><span class="line">//glUniform4f(uColorLocation, 0.0f, 0.0f, 1.0f, 1.0f);</span><br><span class="line">glDrawArrays(GL_POINTS, 8, 1);</span><br><span class="line"></span><br><span class="line">//draw the second red mallets</span><br><span class="line">//glUniform4f(uColorLocation, 1.0f, 0.0f, 0.0f, 1.0f);</span><br><span class="line">glDrawArrays(GL_POINTS, 9, 1);</span><br></pre></td></tr></table></figure>

<h3 id="OpenGl如何把坐标映射到屏幕"><a href="#OpenGl如何把坐标映射到屏幕" class="headerlink" title="OpenGl如何把坐标映射到屏幕"></a>OpenGl如何把坐标映射到屏幕</h3><p>OpenGl会把屏幕映射到x,y轴的[-1, 1]范围内，可以给<code>gl_PointSize</code>赋值来改变点的大小</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://xu6148152.github.io/2016/04/28/A-successful-git-branching-model/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Binea">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2016/04/28/A-successful-git-branching-model/" class="post-title-link" itemprop="url">优秀的git分支模型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-04-28 16:00:43" itemprop="dateCreated datePublished" datetime="2016-04-28T16:00:43+08:00">2016-04-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-06-08 18:12:17" itemprop="dateModified" datetime="2022-06-08T18:12:17+08:00">2022-06-08</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="好好学习git以及git-flow"><a href="#好好学习git以及git-flow" class="headerlink" title="好好学习git以及git-flow"></a>好好学习git以及git-flow</h3><img data-src="/2016/04/28/A-successful-git-branching-model/git-model.png" class="" title="git model">

<h3 id="分散又集中"><a href="#分散又集中" class="headerlink" title="分散又集中"></a>分散又集中</h3><p>我们的<code>git</code>模型中有个中央仓库”truth”。注意这个仓库只能被当做中央仓库(虽然技术层面上讲，<code>git</code>里并没有中央仓库这个概念)。我们把这个仓库当做<code>origin</code>，因为所有的<code>git</code>用户都对这个名字比较熟悉。</p>
<img data-src="/2016/04/28/A-successful-git-branching-model/centr-decentr.png" class="">

<p>每个开发者从<code>origin</code>拉取或者推送代码。这种关系背后，每个开发者也可以从其他子团队的节点拉取改变的东西。对于多人协作开发时这可能非常有用。上图中有Alice和Bob, Alice和David，Clair和David多个子团队。</p>
<p>技术层面上讲，就是Alice定义了一个远程Git，名叫bob,指向Bob的仓库。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/04/28/A-successful-git-branching-model/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://xu6148152.github.io/2016/04/27/Google-Agera-vs-ReactiveX/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Binea">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2016/04/27/Google-Agera-vs-ReactiveX/" class="post-title-link" itemprop="url">Google Agera vs. ReactiveX</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-04-27 14:48:15" itemprop="dateCreated datePublished" datetime="2016-04-27T14:48:15+08:00">2016-04-27</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="http://akarnokd.blogspot.com/2016/04/google-agera-vs-reactivex.html">原文</a></p>
<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>如果你经常关注<code>Android</code>开发动态的话，或者关注<code>Reactive</code>相关的动态,最近<code>Google</code>有个重大发布。它们发布了针对于<code>Android</code>的反应式编程库:<code>Agera</code>。</p>
<p><code>By Google</code>是<code>Google</code>一个从事<code>Google Play Movies</code>的小组。当然，这听起来更像<code>Google</code>.</p>
<p>不管是谁发布的，我们要关注的是，它与现有的反应式编程库<code>RxJava</code>,<code>Reactor</code>以及<code>Akka-Streams</code>有什么区别</p>
<h3 id="核心API"><a href="#核心API" class="headerlink" title="核心API"></a>核心API</h3><p><code>Agera</code>基于少值观察者模式:被观察者通过<code>update()</code>拿到更新和变化的信号.然后响应这些变化来算出什么改变了。以下是一个无参反应式数据流，它依赖一端<code>update</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">interface Updatable &#123;</span><br><span class="line">    void update();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">interface Observable &#123;</span><br><span class="line">   void addUpdatable(Updatable u);</span><br><span class="line">   void removeUpdatable(Updatable u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>它们看起来挺合理的？不幸的事，它们也有<code>java.util.Observable</code>和其他基于<code>addListener/removeListener</code>的反应式API</p>
<h3 id="Agera-Observable"><a href="#Agera-Observable" class="headerlink" title="Agera Observable"></a>Agera Observable</h3><p>这对方法的问题是每个添加了<code>Updatable</code>行为的<code>Observable</code>都不得不去记住原始的<code>Updatable</code>以便能移除同样的<code>Updatable</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">public final class DoOnUpdate implements Observable &#123;</span><br><span class="line">    final Observable source;</span><br><span class="line"> </span><br><span class="line">    final Runnable action;</span><br><span class="line"> </span><br><span class="line">    final ConcurrentHashMap&lt;Updatable, DoOnUpdatable&gt; map;</span><br><span class="line"> </span><br><span class="line">    public DoOnUpdate(Observable source, Runnable action) &#123;</span><br><span class="line">         this.source = source;</span><br><span class="line">         this.action = action;</span><br><span class="line">         this.map = new ConcurrentHashMap&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void addUpdatable(Updatable u) &#123;</span><br><span class="line">        DoOnUpdatable wrapper = new DoOnUpdatable(u, action);</span><br><span class="line">        if (map.putIfAbsent(u, wrapper) != null) &#123;</span><br><span class="line">            throw new IllegalStateException(&quot;Updatable already registered&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        source.addUpdatable(wrapper);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public void removeUpdatable(Updatable u) &#123;</span><br><span class="line">        DoOnUpdatable wrapper = map.remove(u);</span><br><span class="line">        if (wrapper == null) &#123;</span><br><span class="line">            throw new IllegalStateException(&quot;Updatable already removed&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        source.removeUpdatable(wrapper);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    static final class DoOnUpdatable &#123;</span><br><span class="line">        final Updatable actual;</span><br><span class="line"> </span><br><span class="line">        final Runnable run;</span><br><span class="line"> </span><br><span class="line">        public DoOnUpdatable(Updatable actual, Runnable run) &#123;</span><br><span class="line">            this.actual = actual;</span><br><span class="line">            this.run = run;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        @Override</span><br><span class="line">        public void update() &#123;</span><br><span class="line">            run.run();</span><br><span class="line">            actual.update();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这导致一个争论点，在管道的每个阶段独立的下游<code>Updatabels</code>。是的，<code>RxJava&#39;s Subjects</code>和<code>ConnectableObservables</code>也有类似的争议点，但它们之后的链式操作符不会有争议。不幸的是，反应式流规范，在当前版本，<code>Publishers</code>也有类似的问题。现在<code>RxJava2.x</code>,<code>Rsc</code>和<code>Reactor</code>完全忽略了这些东西,结果是操作起来变得更严格了。</p>
<p>第二个微不足道的问题是你不能多次添加相同的<code>Updatable</code>。因为你无法在不同的<code>subscriptions</code>中通过<code>Map</code>区分它们，如果这么干，会出现异常。通常这是很少发生的，因为大多数的终端需求都很单一。</p>
<p>第三个比较大的问题：当<code>Updatable</code>不再注册在<code>Observable</code>时抛出。这在终端用户触发移除操作时，而这个操作又引发别的操作，它们当中一个会抛出异常。这就是为何现在反应式变成不能够被取消的缘故。</p>
<p>第四个理论问题,<code>addUpdatable</code>和<code>removeUpdatable</code>会相互竞争，一些下游的操作符想在某个上游操作符已经调用了<code>addUpdatable</code>之后断开。一个可能的问题是<code>removeUpdate</code>调用抛出异常而<code>addUpdatable</code>成功，这回导致信号流向任何地方和导致相关的对象不想要的持有。</p>
<h3 id="Agera-Updatable"><a href="#Agera-Updatable" class="headerlink" title="Agera Updatable"></a>Agera Updatable</h3><p>我们来从消费者角度看看API。<code>Updatable</code>是一个单一函数接口的方法，这让它能简单的给<code>Observable</code>添加监听</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Observable source = ...</span><br><span class="line">source.addUpdatable(() -&gt; System.out.println(&quot;Something happened&quot;));</span><br></pre></td></tr></table></figure>

<p>相当简单，现在我们移除我们的监听</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source.removeUpdatable(() -&gt; System.out.println(&quot;Something happened&quot;);</span><br></pre></td></tr></table></figure>

<p>这会产生一个异常:两个<code>lambdas</code>不是相同的对象。这在基于<code>addListener/removeListener</code>的API当中是相当常见的问题。解决方案是存储<code>lambda</code>，当需要的时候去用它：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Updatable u = () -&gt; System.out.println(&quot;Something happened&quot;);</span><br><span class="line"> </span><br><span class="line">source.addUpdatable(u);</span><br><span class="line"> </span><br><span class="line">// ...</span><br><span class="line"> </span><br><span class="line">source.removeUpdatable(u);</span><br></pre></td></tr></table></figure>

<p>有点不方便，但不会更糟了。如果你有很多<code>Observables</code>和很多<code>Updatables</code>呢？你需要记住谁注册在谁上，在相同的字段保持引用它们。<code>Rx.NET</code>的原始设计有个好主意来减少这种必须的单引用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">interface Removable extends Closeable &#123;</span><br><span class="line">    @Override</span><br><span class="line">    void close(); // remove the necessity of try-catch around close()</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">public static Removable registerWith(Observable source, Updatable consumer) &#123;</span><br><span class="line">    source.addUpdatable(consumer);</span><br><span class="line">    return () -&gt; source.removeUpdatable(consumer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当然，我们在调用<code>close()</code>时同样需要考虑：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public static Removable registerWith(Observable source, Updatable consumer) &#123;</span><br><span class="line">    source.addUpdatable(consumer);</span><br><span class="line">    final AtomicBoolean once = new AtomicBoolean();</span><br><span class="line">    return () -&gt; &#123;</span><br><span class="line">        if (once.compareAndSet(false, true)) &#123;</span><br><span class="line">            source.removeUpdatable(consumer);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Agera-MutableRepository"><a href="#Agera-MutableRepository" class="headerlink" title="Agera MutableRepository"></a>Agera MutableRepository</h4><p>如果值发生变化，<code>Agera MutableRepository</code>会通过<code>update()</code>通知注册的<code>Updatables</code>。这和<code>BehaviorSubject</code>很像，区别是新值如果不调用<code>get()</code>不会流到消费者:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MutableRepository&lt;integer&gt; repo = Repositories.mutableRepository(0);</span><br><span class="line"> </span><br><span class="line">repo.addUpdatable(() -&gt; System.out.println(&quot;Value: &quot; + repo.get());</span><br><span class="line"> </span><br><span class="line">new Thread(() -&gt; &#123;</span><br><span class="line">    repo.accept(1);</span><br><span class="line">&#125;).start();</span><br></pre></td></tr></table></figure>

<p>当通过工厂方法创建仓库时，<code>Looper</code>中会调用<code>update()</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Set&lt;Integer&gt; set = new HashSet&lt;&gt;();</span><br><span class="line"> </span><br><span class="line">MutableRepository&lt;integer&gt; repo = Repositories.mutableRepository(0);</span><br><span class="line"> </span><br><span class="line">repo.addUpdatable(() -&gt; set.add(repo.get()));</span><br><span class="line"> </span><br><span class="line">new Thread(() -&gt; &#123;</span><br><span class="line">    for (int i = 0; i &lt; 100_000; i++) &#123;</span><br><span class="line">        repo.accept(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).start();</span><br><span class="line"> </span><br><span class="line">Thread.sleep(20_000);</span><br><span class="line"> </span><br><span class="line">System.out.println(set.size());</span><br></pre></td></tr></table></figure>

<p>20秒之后<code>Set</code>最终会有多大？有人可能会认为是100,000。事实上，值可能在1~100,000之间!原因是<code>accept()</code>和<code>get()</code>并发运行，如果消费者运行比较慢，<code>accept()</code>会覆盖当前仓库的值。</p>
<h4 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h4><p>使用异步通常意味着会碰到异步相关的问题。<code>RxJava</code>和其他类似的东西都会有这种问题：出现某种错误了，这个流程自动清掉，而开发者希望的是能够重新开始。错误和清理在某些情况下很复杂，成熟的库都花费了大量的精力来解决这些问题，因此开发者不需要在这上面浪费很多时间。</p>
<p><code>Agera</code>基础API不会自己处理错误，你需要自己对错误进行处理。如果你用<code>Agera</code>组成多个服务，你需要建立自己的错误处理框架.由于并发和中断状态使它处理起来很笨重和延迟。</p>
<h4 id="终结"><a href="#终结" class="headerlink" title="终结"></a>终结</h4><p><code>Agera</code>对一个完成流不会发出通知，你需要自己知道它什么时候会完成。这在简单用户界面上不会有什么问题。然而，后台异步操作需要知道要发出多少信号，没有数据的话，你如何收到<code>update()</code>相关通知</p>
<h3 id="如何设计现代化的无参反应式API"><a href="#如何设计现代化的无参反应式API" class="headerlink" title="如何设计现代化的无参反应式API"></a>如何设计现代化的无参反应式API</h3><p>看看以下例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rx.Observable&lt;Void&gt; signaller = ...</span><br><span class="line"> </span><br><span class="line">rx.Observer&lt;Void&gt; consumer = ...</span><br><span class="line"> </span><br><span class="line">Subscription s = signaller.subscribe(consumer);</span><br><span class="line"> </span><br><span class="line">// ...</span><br><span class="line"> </span><br><span class="line">s.unsubscribe();</span><br></pre></td></tr></table></figure>

<p>你很简单的就能获得它该有的功能。你如果要处理别的类型信号，将<code>Void</code>替换成你想要的类型就可以了。</p>
<p>如果一个库由于需要学习很多操作符而让人感到很笨重的话，你可以拷贝它，删除你不需要的东西。当然，你需要更新修复问题和性能优化后的代码。</p>
<p>如果拷贝和修改听起来不够有吸引力，你能按照<code>Reactive-Streams</code>规定开发自己的库;<code>Publisher&lt;Void&gt;</code>,<code>&lt;Subscriber&lt;Void&gt;</code>和其他东西。你能很方便的与其他的<code>Reactive-Streams</code>库一起工作，你能通过它的兼容性测试来测试你的库。</p>
<p>当然，编写反应式库很麻烦，按照<code>Reactive-Streams</code>编写更麻烦。所以，综合考虑，你可以拓展API</p>
<p>如果你真的想要编写无参反应式流，这有几个你需要考虑的建议：</p>
<p><strong>1)不要分开<code>addListener</code>和<code>removeListener</code>。</strong>单一的入口简化中间操作的开发。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">interface Observable &#123;</span><br><span class="line">    Removable register(Updatable u);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">interface Removable &#123;</span><br><span class="line">    void remove();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2)考虑支持取消和移除而不是返回一个可以取消的令牌或者可移除的动作：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">interface Observable &#123;</span><br><span class="line">    void register(Updatable u);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">interface Updatable &#123;</span><br><span class="line">    void onRegister(Removable remover);</span><br><span class="line">    void update();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// or</span><br><span class="line"> </span><br><span class="line">interface Updatable &#123;</span><br><span class="line">    void update(Removable remover);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>3)考虑至少添加一个错误信号接收：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">interface Updatable &#123;</span><br><span class="line">    void onRegister(Removable remover);</span><br><span class="line">    void update();</span><br><span class="line">    void error(Throwable ex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>4)考虑提供队列的异步操作.</strong></p>
<h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>其实作者就是来黑<code>Agera</code>的。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://xu6148152.github.io/2016/04/04/smaller-apk/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Binea">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2016/04/04/smaller-apk/" class="post-title-link" itemprop="url">APK瘦身</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-04-04 15:16:24" itemprop="dateCreated datePublished" datetime="2016-04-04T15:16:24+08:00">2016-04-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2016-04-24 17:47:56" itemprop="dateModified" datetime="2016-04-24T17:47:56+08:00">2016-04-24</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="APK瘦身系列"><a href="#APK瘦身系列" class="headerlink" title="APK瘦身系列"></a>APK瘦身系列</h3><h4 id="1-解剖APK"><a href="#1-解剖APK" class="headerlink" title="1.解剖APK"></a>1.<a target="_blank" rel="noopener" href="https://medium.com/google-developers/smallerapk-part-1-anatomy-of-an-apk-da83c25e7003?source=user_profile---------8-">解剖APK</a></h4><p>如果我问开发者他们的APP有多大，我能很确定，大部分人会去看下<code>Android Studio</code>生成的APK有多大，然后告诉我。这是最直接的答案。考虑以下例子:</p>
<ul>
<li>当你的APP安装在用户的设备上时会占用多大的空间？</li>
<li>用户需要花费多少的网络流量来下载和安装您的APP</li>
<li>更新APP时，需要下载多少内容？</li>
<li>你的APP运行时占用了多少内存？
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/04/04/smaller-apk/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://xu6148152.github.io/2016/03/14/Building-Android-Apps-30things/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Binea">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2016/03/14/Building-Android-Apps-30things/" class="post-title-link" itemprop="url">Android开发30条经验</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2016-03-14 15:16:24" itemprop="dateCreated datePublished" datetime="2016-03-14T15:16:24+08:00">2016-03-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2016-04-24 17:22:04" itemprop="dateModified" datetime="2016-04-24T17:22:04+08:00">2016-04-24</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Android开发30条经验"><a href="#Android开发30条经验" class="headerlink" title="Android开发30条经验"></a>Android开发30条经验</h2><p>有两种人，一种是自己摸索来学习，一种是通过别人的建议。这儿有些经验我想与你们分享：  </p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2016/03/14/Building-Android-Apps-30things/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://xu6148152.github.io/2015/05/03/Effective-JavaScript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Binea">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/05/03/Effective-JavaScript/" class="post-title-link" itemprop="url">Effective JavaScript</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2015-05-03 17:55:19" itemprop="dateCreated datePublished" datetime="2015-05-03T17:55:19+08:00">2015-05-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2016-12-14 15:16:49" itemprop="dateModified" datetime="2016-12-14T15:16:49+08:00">2016-12-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="习惯JavaScript-7"><a href="#习惯JavaScript-7" class="headerlink" title="习惯JavaScript(7)"></a>习惯JavaScript(7)</h3><ol>
<li>了解使用的<code>JavaScript</code>版本</li>
<li>理解<code>JavaScript</code>浮点数</li>
</ol>
<ul>
<li>JavaScript的数字都是双精度浮点数</li>
<li>JavaSCript的整型是浮点数的一个子集，不是单独的类型</li>
<li>位运算符将数字视为32位有符号整数</li>
<li>浮点数中的精度陷阱</li>
</ul>
<ol start="3">
<li>当心隐式的强制转换</li>
</ol>
<ul>
<li>类型错误可能被隐式的强制转换所隐藏</li>
<li>重载的运算符+是进行加法运算还是字符串连接取决于参数类型</li>
<li>对象通过<code>valueOf</code>方法强制转换成数字，通过<code>toString</code>方法强制转换为字符串</li>
<li>具有<code>valueOf</code>方法的对象应该实现<code>toString</code>方法，返回一个<code>valueOf</code>方法产生的数字字符串表示</li>
<li>测试一个值是否为未定义的值，应该使用<code>typeof</code>或者与<code>undefined</code>进行比较而不是用真值运算</li>
</ul>
<ol start="4">
<li>原型类型优于封装对象</li>
</ol>
<ul>
<li>当做相等比较时，原始类型的封装对象与其原始值行为不一样</li>
<li>或者和设置原始类型值的属性会隐式地创建封装对象</li>
</ul>
<ol start="5">
<li>避免对混合类型使用<code>==</code> 运算符</li>
</ol>
<ul>
<li>当类型不同时，<code>==</code>运算符应用了一套难以理解的隐式强制转换规则</li>
<li>使用<code>===</code></li>
</ul>
<ol start="6">
<li>了解分号插入的局限 </li>
<li>视字符串为16位的代码单元序列</li>
</ol>
<ul>
<li><code>JavaScript</code>字符串由16位的代码单元组成，而不是由<code>Unicode</code>组成</li>
<li><code>JavaScript</code>使用两个代码单元表示2^16及其以上的<code>Unicode</code>的代码点。这两个代码单元被称为代理对。</li>
<li>代理对甩开了字符串元素计数，<code>length、charAt、charCodeAt</code>方法以及正则表达式模式(例如<code>.</code>)受到了影响</li>
<li>使用第三方库识别代码点的字符串操作</li>
</ul>
<h3 id="变量作用域-10"><a href="#变量作用域-10" class="headerlink" title="变量作用域(10)"></a>变量作用域(10)</h3><ol start="8">
<li>尽量减少全局对象</li>
<li>始终声明局部变量</li>
<li>避免使用<code>width</code></li>
<li>熟练掌握闭包</li>
</ol>
<ul>
<li>函数可以引用定义在其外部作用域的变量</li>
<li>闭包比创建它们的函数有更长的生命周期</li>
<li>闭包在内部存储其外部变量的引用，并能读写这些变量</li>
</ul>
<ol start="12">
<li>理解变量声明提升</li>
</ol>
<ul>
<li>在代码块中的变量声明会被隐式地提升到闭包函数的顶部</li>
<li>重声明变量可视为单个变量</li>
<li>考虑手动提升局部变量的声明，从而避免混淆</li>
</ul>
<ol start="13">
<li>使用立即调用的函数表达式创建局部作用域</li>
</ol>
<ul>
<li>理解绑定和赋值的区别</li>
<li>闭包通过引用而不是值捕获它们的外部变量</li>
<li>使用立即调用的函数表达式来创建局部作用域</li>
<li>当心在立即调用的函数表达式中包裹代码块可能会改变其行为的情形</li>
</ul>
<ol start="14">
<li>当心命名函数表达式笨拙的作用域  </li>
<li>当心局部块函数声明笨拙的作用域  </li>
<li>避免使用<code>Eval</code>创建局部变量</li>
<li>间接调用<code>Eval</code>函数优于直接调用</li>
</ol>
<h3 id="使用函数（12）"><a href="#使用函数（12）" class="headerlink" title="使用函数（12）"></a>使用函数（12）</h3><ol start="18">
<li>理解函数调用、方法调用以及构造函数调用之间的不同</li>
</ol>
<ul>
<li>方法调用将被查找方法属性的对象作为调用接收者</li>
<li>函数调用将全局对象作为接收者。</li>
<li>构造函数需要通过<code>new</code>运算符调用，并产生一个新的对象作为其接收者</li>
</ul>
<ol start="19">
<li>熟练掌握高阶函数</li>
</ol>
<ul>
<li>高阶函数是那些将函数作为参数或者返回值的函数</li>
</ul>
<ol start="20">
<li>使用<code>call</code>方法自定义接收者来调用方法</li>
</ol>
<ul>
<li>使用<code>call</code>方法可以调用在给定的对象中不存在的方法</li>
<li>使用<code>call</code>方法定义高阶函数允许使用者给回调函数指定接收者</li>
</ul>
<ol start="21">
<li>使用<code>apply</code>方法通过不同数量的参数调用函数</li>
</ol>
<ul>
<li>使用<code>apply</code>方法指定一个可计算的参数数组来调用可变参数的函数</li>
<li>使用<code>apply</code>方法的第一个参数给可变参数的方法提供一个接收者</li>
</ul>
<ol start="22">
<li>使用<code>arguments</code>创建可变参数的函数</li>
</ol>
<ul>
<li>使用隐式的<code>arguments</code>对象实现可变参数的函数</li>
<li>考虑对可变参数提供一个额外的固定元数的版本，从而使使用者无需借助<code>apply</code>方法</li>
</ul>
<ol start="23">
<li>永远不要修改<code>arguments</code>对象</li>
</ol>
<ul>
<li>使用<code>[].slice.call(arguments)</code>将<code>arguments</code>对象复制到一个真正的数组中再进行修改</li>
</ul>
<ol start="24">
<li>使用变量保持<code>arguments</code>的引用</li>
</ol>
<ul>
<li>当引用<code>arguments</code>时当心函数嵌套层级</li>
<li>绑定一个明确作用域的引用到<code>arguments</code>变量，从而可以在嵌套的函数中引用它</li>
</ul>
<ol start="25">
<li>使用<code>bind</code>方法提取具有确定接收者的方法</li>
</ol>
<ul>
<li>要注意，提取一个方法不会将方法的接收者绑定到方法的对象上</li>
<li>当给高阶函数传递对象方法时，使用匿名函数在适当的接收者上调用该方法</li>
<li>使用<code>bind</code>方法创建绑定到适当接收者的函数</li>
</ul>
<ol start="26">
<li>使用<code>bind</code>方法实现函数柯里化(将函数与其参数的一个子集绑定)</li>
</ol>
<ul>
<li>使用<code>bind</code>方法实现函数柯里化，即创建一个固定需求参数子集的委托函数</li>
<li>传入<code>null</code>或<code>undefined</code>作为接收者的参数来实现函数柯里化</li>
</ul>
<ol start="27">
<li>使用闭包而不是字符串来封装代码</li>
</ol>
<ul>
<li>当将字符串传递给<code>eval</code>函数以执行它们的<code>API</code>时，绝不要在字符串中包含局部变量的引用</li>
<li>接受函数调用的<code>API</code>由于使用<code>eval</code>函数执行字符串的<code>API</code></li>
</ul>
<ol start="28">
<li>不要信赖函数对象的<code>toString</code>方法</li>
<li>避免使用非标准的栈检查属性</li>
</ol>
<h3 id="对象和原型（13）"><a href="#对象和原型（13）" class="headerlink" title="对象和原型（13）"></a>对象和原型（13）</h3><ol start="30">
<li>理解<code>prototype、getPrototypeOf</code>和__proto__之间的不同</li>
</ol>
<ul>
<li><code>C.prototype</code>属性是<code>new C()</code>创建的对象原型</li>
<li><code>Object.getPrototypeOf(obj)</code>是<code>ES5</code>中检索对象原型的标准函数</li>
<li><code>obj.__proto__</code>是检索对象原型的非标准方法</li>
<li>类是由一个构造函数和一个关联的原型组成的一种设计模式</li>
</ul>
<ol start="31">
<li>使用<code>Object.getPrototypeOf</code>函数而不要使用<code>__proto__</code>属性</li>
<li>始终不要修改<code>__proto__</code>属性</li>
</ol>
<ul>
<li>使用<code>Object.create</code>函数给新对象设置自定义的原型</li>
</ul>
<ol start="33">
<li>使构造函数与<code>new</code>操作符无关</li>
<li>在原型中存储方法</li>
</ol>
<ul>
<li>将方法存储在实例对象中将创建该函数的多个副本，因为每个实例对象都有一份副本</li>
<li>将方法存储于原型中优于存储在实例对象中</li>
</ul>
<ol start="35">
<li>使用闭包存储私有数据</li>
</ol>
<ul>
<li>闭包变量是私有的，只能通过局部的引用获取</li>
<li>将局部变量作为私有数据从而通过方法实现信息隐藏</li>
</ul>
<ol start="36">
<li>只将实例状态存储在实例对象中</li>
</ol>
<ul>
<li>共享可变数据可能会出问题，因为原型是被其所有的实例共享的</li>
<li>将可变的实例状态存储在实例对象中</li>
</ul>
<ol start="37">
<li>认识到<code>this</code>变量的隐式绑定问题</li>
</ol>
<ul>
<li><code>this</code>变量的作用域总是由其最近的封闭函数所绑定</li>
<li>使用一个局部变量(通常命名为<code>self</code>、<code>me</code>或<code>that</code>)使得<code>this</code>绑定对于内部函数是可用的</li>
</ul>
<ol start="38">
<li>在子类的构造函数中调用父类的构造函数</li>
</ol>
<ul>
<li>使用<code>Object.create</code>函数来构造子类的原型对象以避免调用父类的构造函数</li>
</ul>
<ol start="39">
<li>不要重用父类的属性名</li>
<li>避免继承标准类</li>
</ol>
<ul>
<li>使用属性委托优于继承标准类</li>
</ul>
<ol start="41">
<li>将原型视为实现细节</li>
</ol>
<ul>
<li>对象是接口，原型是实现</li>
</ul>
<ol start="42">
<li>避免使用轻率的猴子补丁</li>
</ol>
<h3 id="数组和字典（10）"><a href="#数组和字典（10）" class="headerlink" title="数组和字典（10）"></a>数组和字典（10）</h3><ol start="43">
<li>使用<code>Object</code>的直接实例构造轻量级的字典</li>
<li>使用<code>null</code>原型以防止原型污染</li>
<li>使用<code>hasOwnProperty</code>方法以避免原型污染</li>
</ol>
<ul>
<li>使用词法作用域和<code>call</code>方法避免覆盖<code>hasOwnProperty</code>方法</li>
</ul>
<ol start="46">
<li>使用数组而不要使用字典来存储有序集合</li>
<li>绝不要在<code>Object.prototype</code>中增加可枚举的属性</li>
</ol>
<ul>
<li>避免在<code>Object.prototype</code>中增加属性</li>
<li>考虑编写一个函数代替<code>Object.prototype</code>方法</li>
</ul>
<ol start="48">
<li>避免在枚举期间修改对象</li>
</ol>
<ul>
<li>当使用<code>for..in</code>循环枚举一个对象的属性时确保不要修改该对象</li>
<li>当迭代一个对象时，如果该对象的内容可能会在循环期间被改变，应该使用<code>while</code>循环或经典的<code>for</code>循环来替代<code>for..in</code>循环</li>
<li>为了在不断变化的数据结构中能够预测枚举，考虑使用一个有序的数据结构</li>
</ul>
<ol start="49">
<li>数组迭代要优先使用<code>for</code>循环而不是<code>for..in</code>循环</li>
<li>迭代方法优先于循环</li>
<li>在类数组对象上复用通用的数组方法</li>
<li>数组字面量优于数组构造函数</li>
</ol>
<h3 id="库和API设计-8"><a href="#库和API设计-8" class="headerlink" title="库和API设计(8)"></a>库和API设计(8)</h3><ol start="53">
<li>保持一致的约定</li>
<li>将<code>undefined</code>看做“没有值”</li>
</ol>
<ul>
<li>在允许0、NaN或空字符串为有效参数的地方，绝不要通过真值测试来实现参数默认值</li>
</ul>
<ol start="55">
<li>接收关键字参数的选项对象</li>
</ol>
<ul>
<li>使用<code>extend</code>函数抽象出从选项对象中提取值的逻辑</li>
</ul>
<ol start="56">
<li>避免不必要的状态</li>
</ol>
<ul>
<li>尽可能地使用无状态的<code>API</code></li>
<li>如果<code>API</code>是有状态的，标示出每个操作与哪些状态有关联</li>
</ul>
<ol start="57">
<li>使用结构类型设计灵活的接口</li>
</ol>
<ul>
<li>使用结构类型来设计灵活的对象接口</li>
<li>结构接口更灵活、更轻便，所以应该避免使用继承</li>
</ul>
<ol start="58">
<li>区分数组对象和类数组对象</li>
<li>避免过度的强制转换</li>
<li>支持方法链</li>
</ol>
<ul>
<li>使用方法链来连接无状态的操作</li>
<li>通过在无状态的方法中返回新对象来支持方法链</li>
<li>通过在有状态的方法中返回<code>this</code>来支持方法链</li>
</ul>
<h3 id="并发-8"><a href="#并发-8" class="headerlink" title="并发(8)"></a>并发(8)</h3><ol start="61">
<li>不要阻塞I&#x2F;O事件队列</li>
</ol>
<ul>
<li>异步<code>API</code>使用回调函数来延缓代价高昂的操作以避免阻塞主应用程序</li>
<li><code>JavaScript</code>并发地接收事件，但会使用一个事件队列按序地处理事件处理程序</li>
<li>在应用程序事件队列中绝不要使用阻塞的<code>I/O</code></li>
</ul>
<ol start="62">
<li>在异步序列中使用嵌套或命名的回调函数</li>
</ol>
<ul>
<li>使用嵌套或命名的回调函数按顺序地执行多个异步操作</li>
</ul>
<ol start="63">
<li>当心丢弃错误</li>
<li>对异步循环使用递归</li>
</ol>
<ul>
<li>循环不能是异步</li>
<li>使用递归函数在事件循环的单独伦次中执行迭代</li>
<li>在事件循环的单独轮次中执行递归，并不会导致调用栈溢出</li>
</ul>
<ol start="65">
<li>不要在计算时阻塞事件队列</li>
<li>使用计数器来执行并行操作</li>
<li>绝不要同步地调用异步的回调函数</li>
<li>使用<code>promise</code>模式清洁异步逻辑</li>
</ol>
<ul>
<li><code>promise</code>代表最终值，即并行操作完成时最终产生的结果</li>
<li>使用<code>promise</code>组合不同的并行操作</li>
<li>使用<code>promise</code>模式的<code>API</code>避免数据竞争</li>
<li>在要求有意的竞争条件时使用<code>select</code></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://xu6148152.github.io/2015/03/07/Develop_tips/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Binea">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/03/07/Develop_tips/" class="post-title-link" itemprop="url">Develop Tip</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2015-03-07 15:16:24" itemprop="dateCreated datePublished" datetime="2015-03-07T15:16:24+08:00">2015-03-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2016-12-14 15:16:59" itemprop="dateModified" datetime="2016-12-14T15:16:59+08:00">2016-12-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="开发记录"><a href="#开发记录" class="headerlink" title="开发记录"></a>开发记录</h3><h4 id="Debug"><a href="#Debug" class="headerlink" title="Debug"></a>Debug</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">FragmentManager.enableDebugLoggin(true)</span><br><span class="line"></span><br><span class="line">android.os.Debug.waitForDebugger();</span><br><span class="line"></span><br><span class="line">//trigger your service</span><br><span class="line">&lt;service</span><br><span class="line">	android:name=&quot;....&quot;</span><br><span class="line">	android:exported=&quot;true&quot;</span><br><span class="line">	android:process=&quot;:sync&quot; /&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h4><p><a target="_blank" rel="noopener" href="https://github.com/JakeWharton/hugo">hugo</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://xu6148152.github.io/2015/02/21/Retrofit2.0-RxJava%E7%9A%84MVP%E6%96%B9%E6%A1%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Binea">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/02/21/Retrofit2.0-RxJava%E7%9A%84MVP%E6%96%B9%E6%A1%88/" class="post-title-link" itemprop="url">Retrofit2.0 and RxJava</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2015-02-21 15:16:24" itemprop="dateCreated datePublished" datetime="2015-02-21T15:16:24+08:00">2015-02-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2016-12-14 15:16:05" itemprop="dateModified" datetime="2016-12-14T15:16:05+08:00">2016-12-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="使用Retrofit2-0和RxJava的MVP方案"><a href="#使用Retrofit2-0和RxJava的MVP方案" class="headerlink" title="使用Retrofit2.0和RxJava的MVP方案"></a>使用Retrofit2.0和RxJava的MVP方案</h2><p>设计符合android(MVP)方案的网络架构很有挑战的。当然，更具有挑战的是该设计也还完全符合Android的生命周期。我们能够使用<code>Retrofit</code>，<code>Volley</code>,或者<code>AsyncTask</code>能构建出我们的MVP方案,但我们如何处理当屏幕旋转时的网络请求？</p>
<p>本文的目的是介绍一个能够很简单的使用MVP模式的网络框架，并且能够保证<code>Activity/Fragment</code>生命周期安全。本文需要<code>RxJava</code>和<code>Retrofit</code>的基本认识。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/02/21/Retrofit2.0-RxJava%E7%9A%84MVP%E6%96%B9%E6%A1%88/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://xu6148152.github.io/2015/02/20/GettingStartedWithRxJavaAndAndroid/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Binea">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/02/20/GettingStartedWithRxJavaAndAndroid/" class="post-title-link" itemprop="url">ReativeX</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2015-02-20 15:16:24" itemprop="dateCreated datePublished" datetime="2015-02-20T15:16:24+08:00">2015-02-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2016-12-14 15:16:33" itemprop="dateModified" datetime="2016-12-14T15:16:33+08:00">2016-12-14</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="什么是ReactiveX"><a href="#什么是ReactiveX" class="headerlink" title="什么是ReactiveX"></a>什么是ReactiveX</h3><p><a target="_blank" rel="noopener" href="http://reactivex.io/">ReactiveX</a>是一种API，主要关注使用观察者模式,迭代器模式和具有函数式编程特点的可观察的数据流或者事件的组合和操作。能够处理实时数据，具有高效，简洁，拓展性强的特点。使用观察者和操作者来操作它们，ReactiveX提供一种可组合和弹性API来创建和操作数据流，简化异步编程的一些顾虑，如线程创建和并发问题。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2015/02/20/GettingStartedWithRxJavaAndAndroid/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Binea</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  



  <script src="/js/third-party/fancybox.js"></script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
